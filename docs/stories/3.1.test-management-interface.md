# Story 3.1: Test Management Interface

## Status
Draft

## Story
**As a** test manager,  
**I want** a web interface to create and manage test scenarios,  
**so that** I can easily configure IVR tests.

## Acceptance Criteria
1. Simple forms for test scenario creation
2. List view of existing test scenarios
3. Basic test configuration options
4. Test scenario editing capabilities

## Tasks / Subtasks
- [ ] Create web interface foundation (AC: 1)
  - [ ] Set up FastAPI web application in core
  - [ ] Create HTML/CSS/JavaScript frontend structure
  - [ ] Add test scenario creation forms
  - [ ] Implement form validation and submission
- [ ] Implement scenario list view (AC: 2)
  - [ ] Create scenario listing page
  - [ ] Add search and filtering capabilities
  - [ ] Display scenario metadata and status
  - [ ] Add pagination for large scenario lists
- [ ] Add test configuration options (AC: 3)
  - [ ] Create configuration forms for test settings
  - [ ] Add timeout and retry configuration
  - [ ] Implement DTMF sequence configuration
  - [ ] Add intent validation thresholds
- [ ] Implement editing capabilities (AC: 4)
  - [ ] Create scenario editing interface
  - [ ] Add step-by-step scenario builder
  - [ ] Implement scenario duplication
  - [ ] Add scenario deletion with confirmation

## Dev Notes

### Relevant Source Tree Info
- **Web Application**: `core/web/app.py` - FastAPI web application
- **Templates**: `core/web/templates/` - HTML templates
- **Static Assets**: `core/web/static/` - CSS, JavaScript, images
- **API Routes**: `core/web/routers/scenarios.py` - scenario management endpoints
- **Frontend**: Simple HTML/CSS/JavaScript (no complex framework)

### Architecture Context
This web interface provides user-friendly test scenario management capabilities. It connects to the Test Controller service and SQLite database to provide CRUD operations for test scenarios. The interface is designed to be simple and functional rather than sophisticated.

### Web Interface Structure
```
core/web/
├── app.py                 # Main FastAPI application
├── templates/             # HTML templates
│   ├── base.html         # Base template
│   ├── scenarios/        # Scenario management templates
│   │   ├── list.html     # Scenario list page
│   │   ├── create.html   # Scenario creation form
│   │   ├── edit.html     # Scenario editing form
│   │   └── view.html     # Scenario details view
├── static/               # Static assets
│   ├── css/style.css     # Basic styling
│   ├── js/scenarios.js   # Scenario management JavaScript
│   └── images/           # UI images if needed
└── routers/              # API route handlers
    ├── scenarios.py      # Scenario CRUD operations
    └── monitoring.py     # Real-time monitoring (Epic 3.2)
```

### UI Design Goals
- **Simple Forms**: Clean, easy-to-use forms for scenario creation
- **Clear Navigation**: Intuitive menu and page structure
- **Responsive Design**: Works on desktop browsers
- **Minimal Aesthetics**: Functional over fancy design
- **Keyboard Navigation**: Basic accessibility support

### Scenario Management Features
- **Create Scenario**: Step-by-step wizard for scenario creation
- **List Scenarios**: Table view with search and filtering
- **Edit Scenario**: Modify existing scenarios with validation
- **Delete Scenario**: Safe deletion with confirmation
- **Duplicate Scenario**: Copy existing scenarios for modification

### Scenario Creation Form Structure
```html
<form id="scenario-form">
  <div class="form-group">
    <label>Scenario Name</label>
    <input type="text" name="name" required>
  </div>
  <div class="form-group">
    <label>Description</label>
    <textarea name="description"></textarea>
  </div>
  <div class="form-group">
    <label>Target Phone</label>
    <input type="tel" name="target_phone" required>
  </div>
  <div class="form-group">
    <label>Timeout (seconds)</label>
    <input type="number" name="timeout_seconds" value="300">
  </div>
  <div id="steps-container">
    <!-- Dynamic step creation interface -->
  </div>
</form>
```

### Step Builder Interface
- **Visual Step Editor**: Add/remove/reorder test steps
- **Step Type Selection**: TTS, ASR, DTMF, Intent validation
- **Conditional Logic**: Simple if/then/else conditions
- **Validation**: Real-time form validation

### Integration Points
- **Test Controller API**: REST endpoints for scenario CRUD
- **SQLite Database**: Direct database access for reading scenarios
- **WebSocket**: Real-time updates (implemented in Epic 3.2)

### API Endpoints
```python
# Scenario Management API
GET /api/v1/scenarios              # List scenarios
POST /api/v1/scenarios             # Create scenario
GET /api/v1/scenarios/{id}         # Get scenario details
PUT /api/v1/scenarios/{id}         # Update scenario
DELETE /api/v1/scenarios/{id}      # Delete scenario

# Web Pages
GET /                              # Dashboard/home page
GET /scenarios                     # Scenario list page
GET /scenarios/create              # Scenario creation page
GET /scenarios/{id}/edit          # Scenario editing page
```

### Testing
**Test File Location**: `core/tests/test_web_interface.py`
**Test Standards**: FastAPI test client for API testing, Selenium for UI testing
**Testing Framework**: pytest with FastAPI TestClient
**Specific Requirements**:
- Test all scenario CRUD operations
- Verify form validation works correctly
- Test responsive design on different screen sizes
- Validate accessibility features
- Test JavaScript functionality

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-27 | 1.0 | Initial story creation | System Architect |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

## QA Results
*Results from QA Agent review will be added here*