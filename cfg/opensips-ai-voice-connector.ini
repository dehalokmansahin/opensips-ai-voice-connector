[opensips]
# Use the Docker Compose service name instead of the Kubernetes DNS name
ip = 172.20.0.5
port = 8088

[engine]
# Bind on all interfaces for event subscriptions
event_ip = 0.0.0.0
# Corrected based on image
event_port = 8089

[rtp]
min_port = 35000
max_port = 35003
bind_ip = 0.0.0.0
# Ana makinenin IP adresi (MicroSIP aynı makinede olduğu için)
ip = 192.168.1.122
#RTP kaynak adresi
rtp_receive_buffer_size = 4096
rtp_sender_stop_timeout = 1.0



[SmartSpeech]
# Vosk STT sunucu bağlantı ayarları
url = ws://vosk-server:2700
websocket_timeout = 5  # Vosk WebSocket bağlantı zaman aşımı (saniye)
channels = 1
send_eof = true

# Piper TTS sunucu bağlantı ayarları
host = piper-tts-server
port = 8000
TTS_VOICE = tr_TR-fahrettin-medium  # Piper TTS için kullanılacak ses modeli

# SIP kullanıcılarının eşleşme deseni
match = ^vosk.*$ 

# SpeechSessionManager specific settings (can be in its own [SpeechSessionManager] section too)
stt_target_sample_rate = 16000
# stt_channels is already above
# send_eof is already above
debug = false # Example, might be overridden by general loglevel

# LLM WebSocket Server Configuration
llm_server_uri = ws://llm-turkish-server:8765

llm_max_tokens = 256
llm_temperature = 0.7

bypass_vad = false
vad_threshold = 0.25
vad_min_speech_ms = 150
vad_min_silence_ms = 450
vad_buffer_chunk_ms = 600
speech_detection_threshold = 1
silence_detection_threshold = 1

speech_timeout_seconds = 10.0
silence_timeout_seconds = 3.0
stale_partial_timeout_seconds = 2.5
barge_in_threshold_seconds = 1.5

tts_target_output_rate = 8000

# New settings from refactoring
stt_max_reconnect_attempts = 5
stt_receive_error_sleep_s = 1.0 # make it float for consistency
stt_reconnect_backoff_base = 2
stt_reconnect_max_backoff_s = 10.0 # make it float
vad_final_buffer_wait_factor = 0.5
vad_final_buffer_wait_additive_s = 0.2
vad_final_buffer_max_wait_s = 1.5


[general]
logfile = vosk_connector.log
loglevel = INFO

[ai]
type = SmartSpeech